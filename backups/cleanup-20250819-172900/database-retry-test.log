ğŸš€ å¼€å§‹æ•°æ®åº“è¿æ¥é‡è¯•æœºåˆ¶æµ‹è¯•
æµ‹è¯•æ—¶é—´: Tue Aug 19 09:03:22 CST 2025
é¡¹ç›®ç›®å½•: /home/devbox/project
=

å¼€å§‹æ•°æ®åº“è¿æ¥é‡è¯•æœºåˆ¶æµ‹è¯•...
ğŸ“‹ æ£€æŸ¥ä¾èµ–...
âœ… Node.js ç‰ˆæœ¬: v20.19.4
âœ… npm ç‰ˆæœ¬: 10.8.2
âœ… ä¾èµ–æ£€æŸ¥å®Œæˆ

ğŸ”§ æ£€æŸ¥ç¯å¢ƒå˜é‡...
âœ… MONGODB_URL: mongodb://root:td6sz...
âœ… ç¯å¢ƒå˜é‡æ£€æŸ¥å®Œæˆ

ğŸ”¨ ç¼–è¯‘ TypeScript ä»£ç ...
âŒ TypeScript ç¼–è¯‘æ£€æŸ¥å¤±è´¥
ğŸš€ å¼€å§‹æ•°æ®åº“è¿æ¥é‡è¯•æœºåˆ¶æµ‹è¯•
æµ‹è¯•æ—¶é—´: Tue Aug 19 09:11:07 CST 2025
é¡¹ç›®ç›®å½•: /home/devbox/project
=

å¼€å§‹æ•°æ®åº“è¿æ¥é‡è¯•æœºåˆ¶æµ‹è¯•...
ğŸ“‹ æ£€æŸ¥ä¾èµ–...
âœ… Node.js ç‰ˆæœ¬: v20.19.4
âœ… npm ç‰ˆæœ¬: 10.8.2
âœ… ä¾èµ–æ£€æŸ¥å®Œæˆ

ğŸ”§ æ£€æŸ¥ç¯å¢ƒå˜é‡...
âœ… MONGODB_URL: mongodb://root:td6sz...
âœ… ç¯å¢ƒå˜é‡æ£€æŸ¥å®Œæˆ

ğŸ”¨ ç¼–è¯‘ TypeScript ä»£ç ...
âœ… TypeScript ç¼–è¯‘æ£€æŸ¥é€šè¿‡

ğŸ”„ æµ‹è¯•æ•°æ®åº“è¿æ¥é‡è¯•æœºåˆ¶...
å¯åŠ¨æ•°æ®åº“é‡è¯•æµ‹è¯•...
ğŸš€ å¼€å§‹æ•°æ®åº“è¿æ¥é‡è¯•æœºåˆ¶æµ‹è¯•
æµ‹è¯•é…ç½®: {
  testDuration: 60000,
  statusCheckInterval: 5000,
  simulateDisconnection: true,
  disconnectionDelay: 20000
}
============================================================
ğŸ“¡ å°è¯•è¿æ¥æ•°æ®åº“...
âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ
[5s] çŠ¶æ€æ£€æŸ¥:
  è¿æ¥çŠ¶æ€: connected
  å¥åº·çŠ¶æ€: å¥åº·
  é‡è¿æ¬¡æ•°: 0
  æ­£åœ¨è¿æ¥: å¦
----------------------------------------
[10s] çŠ¶æ€æ£€æŸ¥:
  è¿æ¥çŠ¶æ€: connected
  å¥åº·çŠ¶æ€: å¥åº·
  é‡è¿æ¬¡æ•°: 0
  æ­£åœ¨è¿æ¥: å¦
----------------------------------------
[15s] çŠ¶æ€æ£€æŸ¥:
  è¿æ¥çŠ¶æ€: connected
  å¥åº·çŠ¶æ€: å¥åº·
  é‡è¿æ¬¡æ•°: 0
  æ­£åœ¨è¿æ¥: å¦
----------------------------------------
ğŸ”Œ æ¨¡æ‹Ÿæ•°æ®åº“è¿æ¥ä¸­æ–­...
[20s] çŠ¶æ€æ£€æŸ¥:
  è¿æ¥çŠ¶æ€: disconnecting
  å¥åº·çŠ¶æ€: ä¸å¥åº·
  é‡è¿æ¬¡æ•°: 0
  æ­£åœ¨è¿æ¥: å¦
----------------------------------------
âš ï¸  æ•°æ®åº“è¿æ¥å·²æ–­å¼€ï¼Œç­‰å¾…è‡ªåŠ¨é‡è¿...
[25s] çŠ¶æ€æ£€æŸ¥:
  è¿æ¥çŠ¶æ€: connected
  å¥åº·çŠ¶æ€: å¥åº·
  é‡è¿æ¬¡æ•°: 0
  æ­£åœ¨è¿æ¥: å¦
----------------------------------------
[30s] çŠ¶æ€æ£€æŸ¥:
  è¿æ¥çŠ¶æ€: connected
  å¥åº·çŠ¶æ€: å¥åº·
  é‡è¿æ¬¡æ•°: 0
  æ­£åœ¨è¿æ¥: å¦
----------------------------------------
[35s] çŠ¶æ€æ£€æŸ¥:
  è¿æ¥çŠ¶æ€: connected
  å¥åº·çŠ¶æ€: å¥åº·
  é‡è¿æ¬¡æ•°: 0
  æ­£åœ¨è¿æ¥: å¦
----------------------------------------
[40s] çŠ¶æ€æ£€æŸ¥:
  è¿æ¥çŠ¶æ€: connected
  å¥åº·çŠ¶æ€: å¥åº·
  é‡è¿æ¬¡æ•°: 0
  æ­£åœ¨è¿æ¥: å¦
----------------------------------------
[45s] çŠ¶æ€æ£€æŸ¥:
  è¿æ¥çŠ¶æ€: connected
  å¥åº·çŠ¶æ€: å¥åº·
  é‡è¿æ¬¡æ•°: 0
  æ­£åœ¨è¿æ¥: å¦
----------------------------------------
[50s] çŠ¶æ€æ£€æŸ¥:
  è¿æ¥çŠ¶æ€: connected
  å¥åº·çŠ¶æ€: å¥åº·
  é‡è¿æ¬¡æ•°: 0
  æ­£åœ¨è¿æ¥: å¦
----------------------------------------
[55s] çŠ¶æ€æ£€æŸ¥:
  è¿æ¥çŠ¶æ€: connected
  å¥åº·çŠ¶æ€: å¥åº·
  é‡è¿æ¬¡æ•°: 0
  æ­£åœ¨è¿æ¥: å¦
----------------------------------------
ğŸ æµ‹è¯•å®Œæˆ

ğŸ“Š æµ‹è¯•æŠ¥å‘Š
============================================================
æ€»æ£€æŸ¥æ¬¡æ•°: 11
å¥åº·æ£€æŸ¥æ¬¡æ•°: 10
ä¸å¥åº·æ£€æŸ¥æ¬¡æ•°: 1
å¥åº·ç‡: 90.91%

è¿æ¥çŠ¶æ€åˆ†å¸ƒ:
  connected: 10 æ¬¡ (90.91%)
  disconnecting: 1 æ¬¡ (9.09%)

æœ€å¤§é‡è¿å°è¯•æ¬¡æ•°: 0

æµ‹è¯•è¯¦ç»†æ•°æ®å·²ä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œå¯é€šè¿‡æ—¥å¿—æŸ¥çœ‹å®Œæ•´è®°å½•ã€‚
âœ… æ•°æ®åº“é‡è¯•æµ‹è¯•å®Œæˆ

ğŸ§ª è¿è¡Œæ•°æ®åº“è¿æ¥å•å…ƒæµ‹è¯•...

> language-learning-backend@1.0.0 test
> jest --testPathPattern=database-connection-retry.test.ts --verbose

PASS src/tests/database-connection-retry.test.ts
  æ•°æ®åº“è¿æ¥é‡è¯•æœºåˆ¶æµ‹è¯•
    è¿æ¥çŠ¶æ€ç®¡ç†
      âœ“ åº”è¯¥èƒ½å¤Ÿè·å–è¿æ¥çŠ¶æ€ä¿¡æ¯ (3 ms)
      âœ“ åº”è¯¥èƒ½å¤Ÿæ£€æŸ¥æ•°æ®åº“å¥åº·çŠ¶æ€ (1 ms)
    è¿æ¥é‡è¯•é€»è¾‘
      âœ“ åº”è¯¥åœ¨è¿æ¥å¤±è´¥æ—¶è¿”å›é€‚å½“çš„é”™è¯¯ä¿¡æ¯ (56 ms)
    è¿æ¥æ± é…ç½®
      âœ“ åº”è¯¥ä½¿ç”¨æ­£ç¡®çš„è¿æ¥æ± é…ç½® (1 ms)
    é”™è¯¯å¤„ç†
      âœ“ åº”è¯¥èƒ½å¤Ÿå¤„ç†æ•°æ®åº“è¿æ¥é”™è¯¯ (1 ms)
      âœ“ åº”è¯¥æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ (1 ms)
    è¿æ¥çŠ¶æ€ç›‘æ§
      âœ“ åº”è¯¥æ­£ç¡®æŠ¥å‘Šè¿æ¥çŠ¶æ€ (1 ms)
      âœ“ åº”è¯¥è·Ÿè¸ªé‡è¿å°è¯•æ¬¡æ•°

Test Suites: 1 passed, 1 total
Tests:       8 passed, 8 total
Snapshots:   0 total
Time:        3.27 s, estimated 5 s
Ran all test suites matching /database-connection-retry.test.ts/i.
âœ… å•å…ƒæµ‹è¯•é€šè¿‡

ğŸ¥ æµ‹è¯•å¥åº·æ£€æŸ¥ç«¯ç‚¹...
å¯åŠ¨åç«¯æœåŠ¡...
ç­‰å¾…æœåŠ¡å¯åŠ¨...
æµ‹è¯•å¥åº·æ£€æŸ¥ç«¯ç‚¹: http://localhost:3000/api/health
âœ… å¥åº·æ£€æŸ¥ç«¯ç‚¹å“åº”æ­£å¸¸
å¥åº·çŠ¶æ€å“åº”: {"status":"healthy","timestamp":"2025-08-19T01:12:30.483Z","uptime":9.925108664,"environment":"production","version":"1.0.0","memory":{"used":43,"total":54,"external":21},"services":{"database":"connected","openai":"configured","elevenlabs":"not_configured","pexels":"configured"},"database_details":{"healthy":true,"state":"connected","reconnectAttempts":0,"isConnecting":false,"status":"connected","readyState":1,"host":"wordpecker-db-mongodb.ns-t1zw83xe.svc","port":27017,"name":"wordpecker"}}
æµ‹è¯•å°±ç»ªæ£€æŸ¥ç«¯ç‚¹: http://localhost:3000/api/ready
âœ… å°±ç»ªæ£€æŸ¥ç«¯ç‚¹å“åº”æ­£å¸¸
å°±ç»ªçŠ¶æ€å“åº”: {"ready":true,"timestamp":"2025-08-19T01:12:33.135Z","checks":{"database":true,"requiredAPIs":true,"optionalAPIs":true,"connectivity":true},"details":{"database":{"status":"connected","state":"connected","reconnectAttempts":0,"readyState":1,"host":"wordpecker-db-mongodb.ns-t1zw83xe.svc","port":27017,"name":"wordpecker"},"apis":{"openai":{"configured":true,"accessible":true},"elevenlabs":{"configured":false,"accessible":false},"pexels":{"configured":true,"accessible":true}}},"warnings":["ElevenLabs API key not configured (optional)"]}
åœæ­¢åç«¯æœåŠ¡...

ğŸ“Š ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š...
âœ… æµ‹è¯•æŠ¥å‘Šå·²ç”Ÿæˆ: /home/devbox/project/logs/database-retry-test-report.md

ğŸ‰ æ•°æ®åº“è¿æ¥é‡è¯•æœºåˆ¶æµ‹è¯•å®Œæˆï¼
æŸ¥çœ‹å®Œæ•´æ—¥å¿—: /home/devbox/project/logs/database-retry-test.log
